(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{64167:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return n(62260)}])},62260:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var r=n(11010),i=n(91309),o=n(70655),a=n(85893),s=n(67294),c=n(99642),u=n(18403),l=n(9473),d=n(11163),f=n(9008),p=n.n(f),h=n(74402),w=n(47041),x=n(5853),m=n(2570);function b(){var e=(0,d.useRouter)(),t=(0,i._)((0,s.useState)((0,a.jsx)(h.Z,{timeout:1e4})),2),n=t[0],f=t[1],b=(0,i._)((0,s.useState)(),2),v=b[0],_=b[1],y=(0,l.v9)(function(e){return e.previousPage}),g=(0,m.y)();return(0,s.useEffect)(function(){function t(){return(t=(0,r._)(function(){var t,n,r,i,a,s,u,l,d,p;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(n=(t=e.query).auth,r=t.code,i=t.fido2,a=t.otp,s=t.consent_reactivation,!v)return[2];if(!n&&!r)return(0,w.setCookie)("last_page",y,{maxAge:0}),u="".concat("localhost"===window.location.hostname?"local-":"").concat(e.locale),[2,window.location="https://discord.com/oauth2/authorize?client_id=1111987560344985660&redirect_uri=https%3A%2F%2Fauthentication-redirection-gateway.cornhub.website&state=".concat(u,"&response_type=code&scope=identify+role_connections.write&prompt=none")];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,c.Sf.post("/auth",{auth:n,code:r,fido2:i,otp:a,consent_reactivation:s,turnstile:v})];case 2:if((l=o.sent()).errored){if((d=l.response.data).requested_deletion_at)return e.push("/login/consentreactivation?auth=".concat(d.auth,"&requested_at=").concat(d.requested_deletion_at)),[2];if(d.supported2FA)return e.push("/login/2fa?auth=".concat(d.auth,"&supported_methods=").concat(d.supported2FA.join("+"))),[2];return f("Failed to validate token. Please try again later.".concat(d&&d.error?" Error: ".concat(d.error):"")),[2]}return(0,w.setCookie)("authentication",l.data.token,{maxAge:Math.floor(l.data.expires_in/1e3)}),p=(0,w.getCookie)("last_page"),(0,w.deleteCookie)("last_page"),window.location=null!=p?p:"/",[3,4];case 3:return o.sent(),f("Failed to validate token. Please try again later."),[3,4];case 4:return[2]}})})).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[e,v]),(0,a.jsxs)("div",{className:"text-center m-auto w-full p-3",children:[(0,a.jsx)(p(),{children:(0,a.jsx)("title",{children:"".concat(g("login.html_title")," - CornHub")})}),null===v?(0,a.jsx)("p",{className:"text-red-500",children:(0,a.jsx)(x.N,{id:"turnstile.verification_failed"})}):null,void 0===v?(0,a.jsx)("p",{className:"text-blue-500",children:(0,a.jsx)(x.N,{id:"turnstile.verifying"})}):null,"string"!=typeof n?n:(0,a.jsx)("p",{children:n}),(0,a.jsx)(u.Nc,{siteKey:"0x4AAAAAAABzV2tD73ijh26J",onSuccess:function(e){return _(e)},onError:function(){return _(null)},options:{action:"login",size:"invisible"}})]})}},18403:function(e,t,n){"use strict";n.d(t,{Nc:function(){return d}});var r=n(85893),i=n(67294);let o=(0,i.forwardRef)(({as:e="div",...t},n)=>(0,r.jsx)(e,{...t,ref:n})),a="cf-turnstile-script",s="onloadTurnstileCallback",c=e=>!!document.getElementById(e),u=({render:e="explicit",onLoadCallbackName:t=s,scriptOptions:{nonce:n="",defer:r=!0,async:i=!0,id:o="",appendTo:u,onError:l,crossOrigin:d=""}={}})=>{let f=o||a;if(c(f))return;let p=document.createElement("script");p.id=f,p.src=`https://challenges.cloudflare.com/turnstile/v0/api.js?onload=${t}&render=${e}`,document.querySelector(`script[src="${p.src}"]`)||(p.defer=!!r,p.async=!!i,n&&(p.nonce=n),d&&(p.crossOrigin=d),l&&(p.onerror=l),("body"===u?document.body:document.getElementsByTagName("head")[0]).appendChild(p))},l={normal:{width:300,height:65},compact:{width:130,height:120},invisible:{width:0,height:0,overflow:"hidden"},interactionOnly:{width:"fit-content",height:"auto"}},d=(0,i.forwardRef)((e,t)=>{let{scriptOptions:n,options:d={},siteKey:f,onSuccess:p,onExpire:h,onError:w,onBeforeInteractive:x,onAfterInteractive:m,onUnsupported:b,onLoadScript:v,id:_,style:y,as:g="div",injectScript:E=!0,...k}=e,N=d.size??"normal",[j,A]=(0,i.useState)("execute"===d.execution?l.invisible:"interaction-only"===d.appearance?l.interactionOnly:l[N]),T=(0,i.useRef)(null),C=(0,i.useRef)(!1),[O,S]=(0,i.useState)(),[$,F]=(0,i.useState)(!1),R=_??"cf-turnstile",q=E?n?.id||`${a}__${R}`:n?.id||a,z=function(e=a){let[t,n]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let t=()=>{c(e)&&n(!0)},r=new MutationObserver(t);return r.observe(document,{childList:!0,subtree:!0}),t(),()=>{r.disconnect()}},[e]),t}(q),P=n?.onLoadCallbackName?`${n.onLoadCallbackName}__${R}`:`${s}__${R}`,I=(0,i.useMemo)(()=>{let e;return{sitekey:f,action:d.action,cData:d.cData,callback:p,"error-callback":w,"expired-callback":h,"before-interactive-callback":x,"after-interactive-callback":m,"unsupported-callback":b,theme:d.theme??"auto",language:d.language??"auto",tabindex:d.tabIndex,"response-field":d.responseField,"response-field-name":d.responseFieldName,size:("invisible"!==N&&(e=N),e),retry:d.retry??"auto","retry-interval":d.retryInterval??8e3,"refresh-expired":d.refreshExpired??"auto",execution:d.execution??"render",appearance:d.appearance??"always"}},[f,d,p,w,h,N,x,m,b]),M=(0,i.useMemo)(()=>JSON.stringify(I),[I]);return(0,i.useImperativeHandle)(t,()=>{if("undefined"==typeof window||!z)return;let{turnstile:e}=window;return{getResponse(){if(!e?.getResponse||!O){console.warn("Turnstile has not been loaded");return}return e.getResponse(O)},reset(){if(!e?.reset||!O){console.warn("Turnstile has not been loaded");return}"execute"===d.execution&&A(l.invisible);try{e.reset(O)}catch(e){console.warn(`Failed to reset Turnstile widget ${O}`,e)}},remove(){if(!e?.remove||!O){console.warn("Turnstile has not been loaded");return}S(""),A(l.invisible),e.remove(O)},render(){if(!e?.render||!T.current||O){console.warn("Turnstile has not been loaded or widget already rendered");return}let t=e.render(T.current,I);return S(t),"execute"!==d.execution&&A(l[N]),t},execute(){if("execute"===d.execution){if(!e?.execute||!T.current||!O){console.warn("Turnstile has not been loaded or widget has not been rendered");return}e.execute(T.current,I),A(l[N])}},isExpired(){if(!e?.isExpired||!O){console.warn("Turnstile has not been loaded");return}return e.isExpired(O)}}},[z,O,d.execution,N,I,T]),(0,i.useEffect)(()=>(window[P]=()=>F(!0),()=>{delete window[P]}),[P]),(0,i.useEffect)(()=>{E&&!$&&u({onLoadCallbackName:P,scriptOptions:{...n,id:q}})},[E,$,P,n,q]),(0,i.useEffect)(()=>{z&&!$&&window.turnstile&&F(!0)},[$,z]),(0,i.useEffect)(()=>{if(!f){console.warn("sitekey was not provided");return}z&&T.current&&$&&!C.current&&(S(window.turnstile.render(T.current,I)),C.current=!0)},[z,f,I,C,$]),(0,i.useEffect)(()=>{window.turnstile&&T.current&&O&&(c(O)&&window.turnstile.remove(O),S(window.turnstile.render(T.current,I)),C.current=!0)},[M,f]),(0,i.useEffect)(()=>{if(window.turnstile&&O&&c(O))return()=>{window.turnstile.remove(O)}},[O]),(0,i.useEffect)(()=>{A("execute"===d.execution?l.invisible:"interaction-only"===I.appearance?l.interactionOnly:l[N])},[d.execution,N,I.appearance]),(0,i.useEffect)(()=>{z&&"function"==typeof v&&v()},[z,v]),(0,r.jsx)(o,{ref:T,as:g,id:R,style:{...j,...y},...k})});d.displayName="Turnstile"}},function(e){e.O(0,[774,888,179],function(){return e(e.s=64167)}),_N_E=e.O()}]);
//# sourceMappingURL=login-3deed9a6bf2b8867.js.map